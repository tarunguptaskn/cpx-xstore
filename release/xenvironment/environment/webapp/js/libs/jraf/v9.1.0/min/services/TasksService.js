define(["ojs/ojcore","jquery","jraf/utils/ValidationUtils","jraf/services/AbstractService","jraf/models/Content"],(function(e,t,n,r,i){"use strict";function s(e,t){if(!n.isObjectStrict(t)||!n.isNonemptyString(t.appCode)||!n.isNonemptyString(t.appVersion))throw new TypeError("TasksService: Invalid configuration.");s.superclass.constructor.apply(this,arguments),this.Nc=t.appCode,this.Uc=t.appVersion,this.kc=encodeURIComponent(this.Nc)}return s.SERVICE_URL_PATH="services/private/NavigationMenu",s.SERVICE_VERSION_OVERRIDE=null,s.MENU_TYPE_TASKS="tasks",s.MENU_TYPE_REPORTS="reports",s.MENU_TYPE_SETTINGS="settings",e.Object.createSubclass(s,r,"TasksService"),s.prototype.getServiceConfiguration=function(){return{baseUri:this.getBaseUri(),appCode:this.Nc,appVersion:this.Uc}},s.prototype.GetStandardHeaders=function(){var e=s.superclass.GetStandardHeaders.apply(this);return e["Accept-Version"]=s.SERVICE_VERSION_OVERRIDE||e["Accept-Version"],e},s.prototype.Vc=function(e){return this.BuildEndpoint(e,s.SERVICE_URL_PATH)},s.prototype.getTasks=function(){return this.getMenu(this.Uc,s.MENU_TYPE_TASKS)},s.prototype.getReports=function(){return this.getMenu(this.Uc,s.MENU_TYPE_REPORTS)},s.prototype.getSettings=function(){return this.getMenu(this.Uc,s.MENU_TYPE_SETTINGS)},s.prototype.getMenu=function(e,n){var r=this,i=this.Vc("?appCode="+this.kc+"&appVersion="+encodeURIComponent(e)+"&menuType="+encodeURIComponent(n)),s=t.ajax(i,{headers:r.GetStandardHeaders(),dataType:"json",xhrFields:{withCredentials:!0}});return this.ConvertAjaxPromise(s).then((function(e){return r.ParseMenuContent(e)}))},s.prototype.ParseMenuContent=function(e){return e.resourceType===i.CONTENT_TYPE_FOLDER&&e.children.forEach((function(e){this.ParseMenuContent(e)}),this),e.resourceType===i.CONTENT_TYPE_MODULE&&(e.moduleBinding=JSON.parse(e.moduleBinding),e.moduleOptions=JSON.parse(e.moduleOptions)),e},s}));