define(["ojs/ojcore","knockout","jraf/models/NavigationConfig","jraf/models/UIShellManager"],(function(t,o,e,n){"use strict";function r(t){if(!(t instanceof e))throw new TypeError("LayoutManager: navigationConfig was not a NavigationConfig instance.");this.renderNavigation=t.hasNavigation(),this.layoutConfigurable=t.isLayoutConfigurable(),this.activeLayout=o.observable(this.Co(t)),this.readOnlyActiveLayout=o.pureComputed((function(){return this.activeLayout()}),this),this.renderMenuPin=o.pureComputed((function(){return this.Ao()}),this),this.renderSidebarMenu=o.pureComputed((function(){return this.Ao()}),this),this.renderHorizontalBarMenu=o.pureComputed((function(){return this.No(e.HORIZONTAL_LAYOUT)}),this)}return r.So=null,r.LOCAL_LAYOUT_KEY="jraf.layout",r.prototype.isLayoutConfigurable=function(){return this.layoutConfigurable},r.prototype.getRenderMenuPin=function(){return this.renderMenuPin},r.prototype.getRenderSidebarMenu=function(){return this.renderSidebarMenu},r.prototype.getRenderHorizontalBarMenu=function(){return this.renderHorizontalBarMenu},r.prototype.getActiveLayout=function(){return this.readOnlyActiveLayout},r.prototype.setActiveLayout=function(t){if(!this.isLayoutConfigurable())throw new Error("LayoutManager.setActiveLayout: Layout changes have not been enabled; unable to change layout.");var o=t===e.HORIZONTAL_LAYOUT;if(!o&&t!==e.SIDEBAR_LAYOUT)throw new Error("LayoutManager.setActiveLayout: Invalid layout value.");o?(n.closeMenu(),n.ResetMenu()):n.ResetPopupMenu(),this.zo(t),this.activeLayout(t)},r.prototype.getLayouts=function(){return[{id:e.SIDEBAR_LAYOUT,label:"jraf.global.sidebarLayoutLabel"},{id:e.HORIZONTAL_LAYOUT,label:"jraf.global.topBarLayoutLabel"}]},r.prototype.Ao=function(){return this.No(e.SIDEBAR_LAYOUT)},r.prototype.No=function(t){var o=this.activeLayout();return this.renderNavigation&&o===t},r.prototype.hasSidebarLayoutSupport=function(){return this.Go(e.SIDEBAR_LAYOUT)},r.prototype.hasHorizontalBarLayoutSupport=function(){return this.Go(e.HORIZONTAL_LAYOUT)},r.prototype.Go=function(t){return this.renderNavigation&&(this.isLayoutConfigurable()||this.activeLayout()===t)},r.dispose=function(){r.So=null},r.getInstance=function(t){return t instanceof e&&(null!==r.So&&r.dispose(),r.So=new r(t)),r.So},r.prototype.Co=function(t){var o=this.Ho();return e.isValidLayout(o)&&t.isLayoutConfigurable()?o:t.getDefaultNavigationLayout()},r.prototype.Ho=function(){return window.localStorage.getItem(r.LOCAL_LAYOUT_KEY)},r.prototype.zo=function(t){window.localStorage.setItem(r.LOCAL_LAYOUT_KEY,t)},r}));