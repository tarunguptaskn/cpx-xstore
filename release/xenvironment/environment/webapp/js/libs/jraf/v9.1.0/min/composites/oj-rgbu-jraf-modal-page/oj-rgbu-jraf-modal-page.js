define(["knockout","jquery","ojs/ojlogger","ojs/ojanimation","jraf/composites/utils/TranslationLoaderUtil","module","ojs/ojbutton","ojs/ojmoduleanimations","ojs/ojanimation","jraf/composites/oj-rgbu-jraf-apps-module/loader"],(function(e,t,o,n,s,i){"use strict";function a(t){var n=(this.X=t).uniqueId;this.closeButtonId=n+"_closeButton",this.modalPageId=n+"_modalPage",this.appsModuleId=n+"_appsModule",this.pageClosed=e.observable(!0),this.pageDisplay=e.pureComputed((function(){return this.pageClosed()?"none":"block"}),this),this.pageContentModule=e.observable(),this.pageContentModuleOptions=e.observable(),this.renderPageContentModule=e.pureComputed((function(){return!this.pageClosed()&&(this.pageContentModule()||this.pageContentModuleOptions())}),this),this.headerClass=e.observable(""),this.headerClassString=e.pureComputed((function(){return"oj-flex-bar oj-sm-align-items-center oj-rgbu-jraf-modal-page-title-bar "+this.headerClass()}),this),this.bodyClass=e.observable(""),this.bodyClassString=e.pureComputed((function(){return"oj-flex-item oj-rgbu-jraf-modal-page-body "+this.bodyClass()}),this);var s=this;this.closeModalPage=function(){s.close().catch((function(){o.info("oj-rgbu-jraf-modal-page: modal page close was cancelled.")}))},this.J=a.y.getTranslations(),this.N=Promise.all([this.J,t.properties]).then((function(e){s.M(e[0],e[1])}))}return a.y=new s("oj-rgbu-jraf-modal-page",i.id),a.prototype.activated=function(){return this.N},a.prototype.open=function(){this.previousActiveElement=document.activeElement,n.fadeIn(t("#"+this.modalPageId)[0],{duration:"250ms"}),this.pageClosed(!1),document.getElementById(this.closeButtonId).focus()},a.prototype.close=function(){if(!this.io())return Promise.reject();var e=this;return n.fadeOut(t("#"+this.modalPageId)[0],{duration:"250ms",persist:"all"}).then((function(){e.so(),e.eo()}))},a.prototype.io=function(){return this.sn("ojRgbuJrafModalPageBeforeClose",!0)},a.prototype.so=function(){this.sn("ojRgbuJrafModalPageClose",!1)},a.prototype.sn=function(e,t){var o={bubbles:!0,cancelable:t};return this.X.element.dispatchEvent(new CustomEvent(e,o))},a.prototype.eo=function(){if(this.pageContentModule(void 0),this.pageContentModuleOptions(void 0),this.pageClosed(!0),this.previousActiveElement){try{this.previousActiveElement.focus()}catch(e){}this.previousActiveElement=void 0}},a.prototype.M=function(e,t){this.closeLabel=e.close,["headerClass","bodyClass"].forEach((function(e){this.nn(t[e])&&this[e](t[e])}),this),t.pageContentModule&&this.pageContentModule(t.pageContentModule),t.pageContentModuleOptions&&this.pageContentModuleOptions(t.pageContentModuleOptions)},a.prototype.ao=function(){var e=this;t(this.X.element).on("keydown.oj-rgbu-jraf-modal-page",(function(t){e.ro(t)}))},a.prototype.nn=function(e){return"string"==typeof e&&0<e.length},a.prototype.ro=function(e){!e.isDefaultPrevented()&&e.keyCode&&e.keyCode===t.ui.keyCode.ESCAPE&&(e.preventDefault(),e.stopImmediatePropagation(),this.closeModalPage())},a.prototype.propertyChanged=function(e){var t=e.property;"external"!==e.updatedFrom||"pageContentModule"!==t&&"pageContentModuleOptions"!==t&&"headerClass"!==t&&"bodyClass"!==t||this[t](e.value)},a.prototype.connected=function(){this.ao()},a.prototype.disconnected=function(){this.uo()},a.prototype.uo=function(){t(this.X.element).off("keydown.oj-rgbu-jraf-modal-page")},a.prototype.invokeModuleEventHandler=function(e,t,o){var n=document.getElementById(this.appsModuleId);if(n)return n.invokeModuleEventHandler(e,t,o)},a}));