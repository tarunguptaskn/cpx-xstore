define(["jraf/jrafcore","jraf/models/UIShellManager","jraf/models/Content"],(function(e,n,t){"use strict";var r=null,s=null;function i(){this._menuPromises={},this._menus={},this.contentLeaves={}}return i.prototype.registerMenuOptions=function(e,r){var s=this,i=r();return n.registerDataPromise(e,i),this._menuPromises[e]=i.then((function(n){var r=n instanceof t?n:new t(n);s._menus[e]=s._buildContentMap(r,{})})),i},i.prototype._buildContentMap=function(e,n){var t=e.getId();if(n[t]=e,e.isFolder())for(var r=e.getChildren(),s=0;s<r.length;s++){var i=r[s];this._buildContentMap(i,n)}else e.isLaunchable()&&(this.contentLeaves[t]=e);return n},i.prototype.getMenuContent=function(e){var n=this;return this._menuPromises[e].then((function(){return n._menus[e]}))},i.prototype.getContentLeaves=function(){var e=this,n=[];for(var t in this._menuPromises)n.push(this._menuPromises[t]);return Promise.all(n).then((function(){return e.contentLeaves}))},i.getInstance=function(){var n=e.App.getUserData().userid;return null!==r&&s===n||(r=new i,s=n),r},i}));