define(["knockout","ojs/ojcore","jraf/jrafcore","jraf/models/notifications/NotificationsFilter","jraf/utils/ValidationUtils","ojs/ojarraydataprovider","ojs/ojlabel","ojs/ojselectsingle","ojs/ojselectcombobox","ojs/ojbutton","ojs/ojformlayout"],(function(e,i,t,s,r,l){"use strict";var o=i.Translations.getTranslatedString;function a(e){if(!(r.isObjectStrict(e)&&r.isFunction(e.loadDataCallback)&&r.isFunction(e.closeTabCallback)&&e.filter instanceof s))throw new TypeError("FiltersTab: Invalid Parameters");this.filterFormId=t.UIShell.generateUniqueId(),this.filterTimeSelectId=t.UIShell.generateUniqueId(),this.filterTypeSelectId=t.UIShell.generateUniqueId(),this.filterSeveritySelectId=t.UIShell.generateUniqueId(),this.filterTimeSelectLabel=o("jraf.sidebar.notifications.filterTimeLabel"),this.filterTypeSelectLabel=o("jraf.sidebar.notifications.filterTypeLabel"),this.filterSeveritySelectLabel=o("jraf.sidebar.notifications.filterSeverityLabel"),this.filterResetLabel=o("jraf.sidebar.notifications.filterReset"),this.filterTimePlaceholder=o("jraf.sidebar.notifications.timeAny"),this.filterTypePlaceholder=o("jraf.sidebar.notifications.filterTypePlaceholder"),this.filterSeverityPlaceholder=o("jraf.sidebar.notifications.filterSeverityPlaceholder"),this.applyLabel=o("jraf.sidebar.notifications.filterApply"),this.cancelLabel=o("jraf.sidebar.notifications.filterCancel"),this._loadMenuData=e.loadDataCallback,this._closeTab=e.closeTabCallback,this._notificationsFilter=e.filter,this._initialize()}return a.prototype._initialize=function(){var i=this,t={};t.time=e.observable(this._notificationsFilter.selectedTimePeriod()),this._notificationsFilter.selectedTimePeriod.subscribe((function(e){i.activeFilter.time(e)})),t.type=e.observableArray(this._notificationsFilter.selectedNotificationTypes()),this._notificationsFilter.selectedNotificationTypes.subscribe((function(e){i.activeFilter.type(e)})),t.severity=e.observableArray(this._notificationsFilter.selectedSeverities()),this._notificationsFilter.selectedSeverities.subscribe((function(e){i.activeFilter.severity(e)})),this.activeFilter=t,this.timeSelectOptions=this._notificationsFilter.timePeriodOptions,this.timeSelectOptionsDataProvider=new l(this.timeSelectOptions,{keyAttributes:"value"}),this.severitySelectOptions=this._notificationsFilter.severityOptions,this.filterTypeSelectOptions=this._notificationsFilter.notificationTypeOptions,this._previousFilter={time:e.observable(void 0),type:e.observableArray([]),severity:e.observableArray([])},this._cacheFilters(),this.resetFilters=function(){i._resetFilters()},this.revertFilters=function(){i._revertFilters()},this.executeFilters=function(){i._executeFilters()}},a.prototype._resetFilters=function(){this.activeFilter.time(void 0),this.activeFilter.type([]),this.activeFilter.severity([])},a.prototype._revertFilters=function(){this.activeFilter.time(this._previousFilter.time()),this.activeFilter.type(this._previousFilter.type()),this.activeFilter.severity(this._previousFilter.severity()),this._closeTab()},a.prototype._executeFilters=function(){this._cacheFilters(),this._applyFilters(),this._loadMenuData(),this._closeTab(),this._notificationsFilter.selectedTileIndex()===s.FILTER_TILE_INDEX&&this._notificationsFilter.selectedTileIndex(s.FILTER_TILE_INDEX)},a.prototype._cacheFilters=function(){this._previousFilter.time(this.activeFilter.time()),this._previousFilter.type(this.activeFilter.type()),this._previousFilter.severity(this.activeFilter.severity())},a.prototype._applyFilters=function(){this._notificationsFilter.selectedTimePeriod(this.activeFilter.time()),this._notificationsFilter.selectedNotificationTypes(this.activeFilter.type()),this._notificationsFilter.selectedSeverities(this.activeFilter.severity())},a}));