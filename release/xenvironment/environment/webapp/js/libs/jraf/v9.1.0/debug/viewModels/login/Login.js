define(["ojs/ojcore","knockout","jraf/utils/ValidationUtils","jraf/models/UIShellManager","jraf/utils/RouterUtils","jraf/controllers/LayoutManager","ojs/ojknockout","ojs/ojcomposite","jraf/composites/oj-rgbu-jraf-message-dialog/loader","ojs/ojinputtext","ojs/ojbutton","ojs/ojlabel","ojs/ojformlayout"],(function(o,t,i,e,n,r){"use strict";var s=o.Translations.getTranslatedString;function a(e){if(!i.isObjectStrict(e)||!i.isFunction(e.getLoginHandlerCallback))throw new TypeError("Login: Invalid param(s).");var n=this,r=i.isNonemptyString(e.fromCopyrightYear)?e.fromCopyrightYear:"xxxx",a=i.isNonemptyString(e.toCopyrightYear)?e.toCopyrightYear:"xxxx";this.headerText=s("jraf.login.loginHeader"),this.userIdLabel=s("jraf.login.userName"),this.passwordLabel=s("jraf.login.password"),this.loginErrorMessage=s("jraf.login.loginErrorMessage"),this.loginLabel=s("jraf.login.login"),this.okButtonLabel=s("jraf.common.ok"),this.copyrightStatement=s("jraf.login.copyright",{fromYear:r,toYear:a}),this.trademarksStatement=s("jraf.login.trademarks"),this._layoutMonitor=o.ResponsiveKnockoutUtils.createScreenRangeObservable(),this.isMobileLayout=t.pureComputed((function(){return this._layoutMonitor()===o.ResponsiveUtils.SCREEN_RANGE.SM}),this),this.layoutFlexClasses=t.pureComputed((function(){return this.isMobileLayout()?"oj-flex":"oj-flex-bar oj-flex-items-pad"}),this),this.layoutFlexItemClasses=t.pureComputed((function(){return this.isMobileLayout()?"oj-flex-item":"oj-flex-bar-end"}),this),this.mobileLayoutInputtext=t.pureComputed((function(){return this.isMobileLayout()?"jraf-mobile-login-inputext":{}}),this),this.mobileLayoutButton=t.pureComputed((function(){return this.isMobileLayout()?"jraf-mobile-login-button":{}}),this),this.formLabelEdge=t.pureComputed((function(){return this.isMobileLayout()?"top":"start"}),this),this.userName=t.observable(""),this.pwd=t.observable(""),this.handlingLogin=t.observable(!1),this.loginHandler=e.getLoginHandlerCallback,this.processLogin=function(o){n._handleLogin(o)},this.dismissDialog=function(){n._dismissDialog()},this.onSubmit=function(o){n._onSubmit(o)}}return a.prototype._onSubmit=function(o){o.preventDefault()},a.prototype._handleLogin=function(){o.Logger.info("Login._handleLogin: Entering.");var t=this;document.getElementById("uid").blur(),document.getElementById("pwd").blur(),e.startProcessingIndicator(),this.handlingLogin(!0),this.loginHandler(this.userName(),this.pwd()).then((function(){t._handleLoginSuccess()})).catch((function(){t._handleLoginFailure()}))},a.prototype._handleLoginLoadingComplete=function(){e.stopProcessingIndicator(),this.handlingLogin(!1)},a.prototype._handleLoginSuccess=function(){o.Logger.info("Login._handleLoginSuccess: Entering."),this._handleLoginLoadingComplete(),n.go("Home")},a.prototype._handleLoginFailure=function(){o.Logger.info("Login._handleLoginFailure: Entering."),this._handleLoginLoadingComplete(),this._getDialog().open()},a.prototype._getDialog=function(){return document.getElementById("jraf-login-failed-dialog")},a}));