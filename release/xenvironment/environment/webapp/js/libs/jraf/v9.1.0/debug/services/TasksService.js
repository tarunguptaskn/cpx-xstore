define(["ojs/ojcore","jquery","jraf/utils/ValidationUtils","jraf/services/AbstractService","jraf/models/Content"],(function(e,t,n,r,i){"use strict";function o(e,t){if(!n.isObjectStrict(t)||!n.isNonemptyString(t.appCode)||!n.isNonemptyString(t.appVersion))throw new TypeError("TasksService: Invalid configuration.");o.superclass.constructor.apply(this,arguments),this._appCode=t.appCode,this._appVersion=t.appVersion,this._appCodeUriString=encodeURIComponent(this._appCode)}return o.SERVICE_URL_PATH="services/private/NavigationMenu",o.SERVICE_VERSION_OVERRIDE=null,o.MENU_TYPE_TASKS="tasks",o.MENU_TYPE_REPORTS="reports",o.MENU_TYPE_SETTINGS="settings",e.Object.createSubclass(o,r,"TasksService"),o.prototype.getServiceConfiguration=function(){return{baseUri:this.getBaseUri(),appCode:this._appCode,appVersion:this._appVersion}},o.prototype.GetStandardHeaders=function(){var e=o.superclass.GetStandardHeaders.apply(this);return e["Accept-Version"]=o.SERVICE_VERSION_OVERRIDE||e["Accept-Version"],e},o.prototype._buildTasksEndpoint=function(e){return this.BuildEndpoint(e,o.SERVICE_URL_PATH)},o.prototype.getTasks=function(){return this.getMenu(this._appVersion,o.MENU_TYPE_TASKS)},o.prototype.getReports=function(){return this.getMenu(this._appVersion,o.MENU_TYPE_REPORTS)},o.prototype.getSettings=function(){return this.getMenu(this._appVersion,o.MENU_TYPE_SETTINGS)},o.prototype.getMenu=function(e,n){var r=this,i=this._buildTasksEndpoint("?appCode="+this._appCodeUriString+"&appVersion="+encodeURIComponent(e)+"&menuType="+encodeURIComponent(n)),o=t.ajax(i,{headers:r.GetStandardHeaders(),dataType:"json",xhrFields:{withCredentials:!0}});return this.ConvertAjaxPromise(o).then((function(e){return r.ParseMenuContent(e)}))},o.prototype.ParseMenuContent=function(e){return e.resourceType===i.CONTENT_TYPE_FOLDER&&e.children.forEach((function(e){this.ParseMenuContent(e)}),this),e.resourceType===i.CONTENT_TYPE_MODULE&&(e.moduleBinding=JSON.parse(e.moduleBinding),e.moduleOptions=JSON.parse(e.moduleOptions)),e},o}));