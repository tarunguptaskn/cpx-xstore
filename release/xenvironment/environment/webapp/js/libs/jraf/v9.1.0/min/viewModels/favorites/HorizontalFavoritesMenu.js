define(["jquery","ojs/ojcore","knockout","jraf/jrafcore","jraf/models/favorites/FavoritesContent","jraf/models/favorites/FavoritesConfig","jraf/models/UIShellManager","jraf/utils/ValidationUtils","jraf/models/Content","ojs/ojmodule-element-utils","ojs/ojbutton","ojs/ojmodule-element"],(function(e,t,i,a,o,r,s,n,d,l){"use strict";var v=t.Translations.getTranslatedString;function h(e){var t=this;this.favoriteHandlerKey=e?e.favoriteHandlerKey:void 0,this.hidePinnedFavorites=n.getBoolean(e.hidePinnedFavorites,!1),this.hideEditFavorites=n.getBoolean(e.hideEditFavorites,!1),this.favoritesNavListId=a.UIShell.generateUniqueId(),this.editFavoritesButtonLabel=v("jraf.sidebar.favorites.editFavoritesLabel"),this.defaultEditFavoritesPageTitle=v("jraf.sidebar.favorites.editFavoritesPageTitle"),this.editFavoritesPageTitle=e.editFavoritesPageTitle||this.defaultEditFavoritesPageTitle,this.loadingText=v("jraf.messages.loading"),this.av=r.getInstance().getFavoriteHandler(this.favoriteHandlerKey),this.Al=o.getInstance(this.av.getFavoritesService(),this.favoriteHandlerKey),this.gd=this.Al.getFavorites();var s=i.observable(!1);this.menuDataLoaded=i.pureComputed((function(){return s()})),this.drilledPath=i.observableArray([]),this.isHierarchyRoot=i.pureComputed((function(){return t.drilledPath().length<1})),this.lastDrilledNode=i.pureComputed((function(){return t.isHierarchyRoot()?null:t.drilledPath()[t.drilledPath().length-1]})),this.drilledNodeLabel=i.pureComputed((function(){return t.isHierarchyRoot()?"":t.fv(t.lastDrilledNode().favorite.entryId)()}));var d={name:"jraf/favorites/FavoritesMenuBody",params:{favoritesNavListId:this.favoritesNavListId,menuDataLoaded:s,favoriteHandlerKey:this.favoriteHandlerKey,hidePinnedFavorites:this.hidePinnedFavorites,drilledPath:this.drilledPath,openContentCallback:function(e){t.Rg(e)}}};this.favoritesBodyModuleConfig=l.createConfig(d),this.editFavorites=function(){t.Pd()},this.navigateUpHierarchy=function(){t.yd()}}return h.prototype.fv=function(e){return this.av.getLocalizedTitle(e)},h.prototype.Rg=function(e){s.closePopupMenu(),this.av.openContent(e)},h.prototype.Pd=function(){s.closePopupMenu(),s.openContent(this.kd()),this.isHierarchyRoot()||this.navigateUpHierarchy()},h.prototype.kd=function(){return d.createModuleGlobalModalPageContent(this.editFavoritesPageTitle,{name:"jraf/favorites/EditFavoritesPage",params:{hidePinnedFavorites:this.hidePinnedFavorites,favoriteHandlerKey:this.favoriteHandlerKey}})},h.prototype.yd=function(t,i){var a=this.lastDrilledNode().guid;e("#"+this.favoritesNavListId).ojNavigationList("collapse",a,!0)},h}));