define(["knockout","jquery","ojs/ojcore","ojs/ojtranslation","ojs/ojcomponentcore","ojs/ojcontext","ojs/ojanimation","./adapters/AdapterCapabilities","./adapters/SimpleGridAdapter","./adapters/JetDataGridAdapter","./adapters/LuxGridAdapter","jraf/composites/utils/TranslationLoaderUtil","ojs/ojarraydataprovider","ojs/ojkeyset","module","ojs/ojtoolbar","ojs/ojmenu","ojs/ojdialog","ojs/ojbutton","ojs/ojoption","ojs/ojradioset","ojs/ojlistview","ojs/ojswitch","ojs/ojselectsingle","ojs/ojjsontreedatasource","ojs/ojknockout","ojs/ojlistviewdnd"],(function(t,e,i,n,o,a,r,s,l,h,u,d,c,p,m){"use strict";function _(t){var e=this;if(1!==t.slotCounts.grid)throw new Error("oj-rgbu-jraf-apps-table: A grid component must be provided in the grid slot.");this._loadingTranslations=_._translationLoader.getTranslations(),this._context=t,this._componentInitializing=Promise.all([this._loadingTranslations,this._context.properties]).then((function(t){e._initializeProperties(t[0],t[1])}))}return _.CHANGEABLE_PROPERTIES=["disableCreate","disableDuplicate","disableEdit","disableView","disableDelete","disableRefresh","disableExport"],_.MENU_VALUE_SEPARATOR="-entry-",_.STANDARD_ACTIONS=["Create","Duplicate","Edit","View","Delete","Refresh","Export"],_.GRID_TAG_JRAF_SIMPLE_GRID="OJ-RGBU-JRAF-SIMPLE-GRID",_.GRID_TAG_JET_DATA_GRID="OJ-DATA-GRID",_.GRID_TAG_LUX_GRID="OJ-LUX-GRID",_.CREATE_PATTERN="create",_.ADD_PATTERN="add",_.SORTS_LIMIT=3,_.FILTER_MENU_OPTIONS_CLEAR_FILTER="clear-filter",_.FILTER_MENU_OPTIONS_MATCH_TYPE_OR="match-type-or",_.FILTER_MENU_OPTIONS_MATCH_TYPE_AND="match-type-and",_.FILTER_MATCH_TYPE_OR="or",_.FILTER_MATCH_TYPE_AND="and",_._translationLoader=new d("oj-rgbu-jraf-apps-table",m.id),_.prototype.activated=function(){return this._componentInitializing},_.prototype._initializeProperties=function(t,e){var i=e.createPatternType===_.ADD_PATTERN,o=e.translations||{},a=this._context.uniqueId;this.wrapperId=a+"_wrapper",this.actionMenuId=a+"_actionMenu",this.viewMenuId=a+"_viewMenu",this.exportMenuId=a+"_exportMenu",this.detachDialogId=a+"_detachDialog",this.toolbarId=a+"_toolbar",this.gridId=a+"_grid",this.columnManagementDialogId=a+"_columnManagementDialog",this.columnManagementListHeaderTmplId=a+"_columnManagementListHeaderTmpl",this.columnManagementListItemTmplId=a+"_columnManagementListItemTmpl",this.columnManagementListItemIdPrefix=a+"_columnManagementListItem",this.columnManagementListViewId=a+"_columnManagementListView",this.sortDialogId=a+"_sortDialog",this.appTableId=a+"_appsTable",this.dialogAnchorId=a+"_dialogAnchor",this.qbeToggle=a+"_qbeToggle",this.detachToggle=a+"_detachToggle",this.manageColumnsContextMenuId=a+"_manageColumnsContextMenu",this.manageColumnsCutOptionId=a+"_manageColumnsCutOption",this.manageColumnsPasteBeforeOptionId=a+"_manageColumnsPasteBeforeOption",this.manageColumnsPasteAfterOptionId=a+"_manageColumnsPasteAfterOption",this.actionMenuLabel=t.actionMenuLabel,this.viewMenuLabel=t.viewMenuLabel,this.sortMenuLabel=t.sortLabel,this.attachButtonLabel=t.attachLabel,this.detachButtonLabel=t.detachLabel,this.createButtonLabel=o.createLabel?o.createLabel:i?t.addLabel:t.createLabel,this.duplicateButtonLabel=o.duplicateLabel?o.duplicateLabel:t.duplicateLabel,this.editButtonLabel=o.editLabel?o.editLabel:t.editLabel,this.viewButtonLabel=o.viewLabel?o.viewLabel:t.viewLabel,this.deleteButtonLabel=o.deleteLabel?o.deleteLabel:t.deleteLabel,this.refreshButtonLabel=o.refreshLabel?o.refreshLabel:t.refreshLabel,this.exportButtonLabel=o.exportLabel?o.exportLabel:t.exportLabel,this.ascendingLabel=t.ascending,this.descendingLabel=t.descending,this.cancelLabel=t.cancel,this.applyLabel=t.ok,this.detachDialogTitle=e.detachDialogTitle||t.defaultDetachTitle,this.sortByFirstLabel=t.sortFirstLabel,this.sortByLaterLabel=t.sortSecondLabel,this.queryLabel=t.queryLabel,this.filterMenuLabel=t.filterMenuLabel,this.clearFiltersLabel=t.clearFiltersLabel,this.filterMatchTypeOr=t.filterMatchTypeOr,this.filterMatchTypeAnd=t.filterMatchTypeAnd,this.exportVisible=t.exportVisible,this.exportAll=t.exportAll,this.enabled=t.enabled,this.manageColumnsLabel=t.manageColumns,this.column=t.column,this.displayed=t.displayed,this.manageColumnsList=t.manageColumnsList,this.resetToDefaults=t.resetToDefaults,this.yesLabel=t.yes,this.noLabel=t.no,this.gripperLabel=t.gripperLabel,this.manageColumnsContextMenuAriaLabel=t.manageColumnsContextMenuAriaLabel,this.toolbarLabel=n.applyParameters(t.toolbarLabel,{gridName:e.gridName}),this._initializeGrid(e),this._initializeColumnDefs(e),this._initializeSortDialog(),this._initializeStandardActions(i,e),this._initializeCustomButtons(e),this._initializeExtraControls(),this._initializeMenus(e.actionMenu),this._setupToolbarRefresh()},_.prototype._initializeGrid=function(t){this._gridElement=this._findGridElement();var e=this._gridElement.id;"string"==typeof e&&e.length>0?this.gridId=e:this._gridElement.id=this.gridId,this._gridAdapter=this._getGridAdapter(this._gridElement),this._supportsHideShowColumns=s.hasCapability(this._gridAdapter,s.HIDE_SHOW_COLUMNS),this._supportsMultiColumnSort=s.hasCapability(this._gridAdapter,s.MULTI_COLUMN_SORT),this.renderQBE=t.filterShown&&s.hasCapability(this._gridAdapter,s.QUERY_BY_EXAMPLE)&&this._gridAdapter.hasConfiguredFilters(this._gridElement),this._supportsExportToExcel=s.hasCapability(this._gridAdapter,s.EXPORT_TO_EXCEL)},_.prototype._findGridElement=function(){return e(this._context.element).find("[slot='grid']").get(0)},_.prototype._getGridAdapter=function(t){var e;switch(t.tagName.toUpperCase()){case _.GRID_TAG_JET_DATA_GRID:e=h;break;case _.GRID_TAG_JRAF_SIMPLE_GRID:e=l;break;case _.GRID_TAG_LUX_GRID:e=u;break;default:e=null}if(e)return e;throw new Error("oj-rgbu-jraf-apps-table: A JET Data Grid element, LUX Grid CCA, or oj-rgbu-jraf-simple-grid must be supplied in the grid slot.")},_.prototype._initializeColumnDefs=function(t){var e=Array.isArray(t.columns),i="object"==typeof t.lux&&null!==t.lux&&Array.isArray(t.lux.columns)&&"object"==typeof t.lux.columnDefs&&null!==t.lux.columnDefs;if(this._renderColumnBasedOptions=e||i,this.renderColumnManagement=this._renderColumnBasedOptions&&this._supportsHideShowColumns,this._columnDefs=[],e)this._columnDefs=t.columns.map((function(t){return this._parseStandardColumnDef(t)}),this);else if(i){var n=t.lux,o=n.columns,a=n.columnDefs;this._columnDefs=o.filter((function(t){return a[t]})).map((function(t){return this._parseLuxColumnDef(t,a[t])}),this)}this.renderColumnManagement&&this._initializeColumnManagement()},_.prototype._initializeColumnManagement=function(){this._initializeColumnManagementCallbacks(),this._initializeColumnManagementList()},_.prototype._initializeColumnManagementCallbacks=function(){var t=this;this.beforeColumnManagementDialogOpen=function(){t._beforeColumnManagementDialogOpen()},this.handleColumnManagementDialogClose=function(e){t._handleColumnManagementDialogClose(e)},this.resetColumnsToDefaults=function(){t._resetColumnsToDefaults()},this.cancelColumnChanges=function(){t._closeManageColumnsDialog()},this.applyColumnChanges=function(){t._applyColumnChanges()},this.handleColumnReorder=function(e){t._handleColumnReorder(e)}},_.prototype._initializeColumnManagementList=function(){this.columnManagementDataSource=t.observable(),this._activeColMgmtListItems=this._getColumnManagementListItems(this._columnDefs),this.columnManagementCurrentItem=t.observable(),this.columnManagementExpandedKeySet=new p.ExpandAllKeySet,this.isColumnManagementListItemFocusable=function(t){return t.leaf},this._refreshColMgmtDataSource(this._activeColMgmtListItems)},_.prototype._getColumnManagementListItems=function(e){return e.map((function(e,i){var n="boolean"!=typeof e.shown||e.shown;return{attr:{id:this.columnManagementListItemIdPrefix+i,value:e.value,label:e.label,shown:t.observable(n)}}}),this)},_.prototype._getColumnConfiguration=function(t){return t.map((function(t){var e=t.attr;return{value:e.value,label:e.label,shown:e.shown()}}))},_.prototype._getColumnManagementDataSource=function(t){return new i.JsonTreeDataSource([{attr:{id:this.columnManagementListItemIdPrefix+"_heading",label:this.manageColumnsLabel},children:t}])},_.prototype._refreshColMgmtDataSource=function(t){this._previousColMgmtConfig=this._getColumnConfiguration(t),this._updateActiveColMgmtDataSource(t)},_.prototype._updateActiveColMgmtDataSource=function(t){this._activeColMgmtListItems=t,this.columnManagementDataSource(this._getColumnManagementDataSource(t))},_.prototype._parseStandardColumnDef=function(t){return{value:t.valueName,label:t.label||t.valueName,sortable:"boolean"!=typeof t.sortable||t.sortable,shown:"boolean"!=typeof t.shown||t.shown}},_.prototype._parseLuxColumnDef=function(t,e){return{value:t,label:e.title||t,sortable:"boolean"==typeof e.sortable&&e.sortable}},_.prototype._initializeDetach=function(){var e=this;this.detachButtonSetValue=t.observableArray([]),this.detachValue="detach",this.detachMenuItemLabel=t.pureComputed((function(){return this.detachButtonSetValue().length>0?this.attachButtonLabel:this.detachButtonLabel}),this),this.detachButtonSetValue.subscribe((function(){e._handleDetachValueChange()})),this.handleDetachDialogClose=function(t){return e._handleDetachDialogClose(t)},this.handleDetachDialogResized=function(t){e._handleDetachDialogResized(t)}},_.prototype._toggleDetachTable=function(){this.detachButtonSetValue().length>0?this.detachButtonSetValue([]):this.detachButtonSetValue([this.detachValue])},_.prototype._handleDetachValueChange=function(){if(0!==this.detachButtonSetValue().length){var t=this;this._performActionWhenReady(this.toolbarId,(function(){t._detachToDialog()}))}else this._closeDialogWhenReady(this.detachDialogId)},_.prototype._detachToDialog=function(){var t=document.getElementById(this.appTableId);o.subtreeDetached(t),document.getElementById(this.dialogAnchorId).appendChild(t),o.subtreeAttached(t),document.getElementById(this.detachDialogId).open(),this._gridAdapter.handleDetached(this._gridElement)},_.prototype._closeDialogWhenReady=function(t){return this._performActionWhenReady(t,(function(){var e=document.getElementById(t);e.isOpen()&&e.close()}))},_.prototype._performActionWhenReady=function(t,e){var i=document.getElementById(t);return a.getContext(i).getBusyContext().whenReady(1e3).then((function(){e()}))},_.prototype._handleDetachDialogClose=function(t){if(t.target!==document.getElementById(this.detachDialogId))return!1;var e=document.getElementById(this.appTableId);o.subtreeDetached(e),document.getElementById(this.wrapperId).appendChild(e),o.subtreeAttached(e),this.detachButtonSetValue().length>0&&this.detachButtonSetValue.pop(),this._gridAdapter.handleAttached(this._gridElement)},_.prototype._handleDetachDialogResized=function(t){this._gridAdapter.handleDetachDialogResized(this._gridElement)},_.prototype._initializeFilters=function(){var e=this;this.filtersEnabledVal="enabled";var i=this.renderQBE&&this._gridAdapter.isFilterInitiallyShown(this._gridElement)?[this.filtersEnabledVal]:[];this.filtersSelection=t.observableArray(i),this._filtersEnabled=t.pureComputed((function(){return this.filtersSelection().length>0}),this),this._filtersEnabled.subscribe((function(){e._handleQBEToggle()}))},_.prototype._toggleQBE=function(){this._filtersEnabled()?this.filtersSelection.removeAll():this.filtersSelection([this.filtersEnabledVal]),this._refreshViewMenu()},_.prototype._refreshViewMenu=function(){document.getElementById(this.viewMenuId).refresh()},_.prototype._handleQBEToggle=function(){this._filtersEnabled()?this._gridAdapter.showFilters(this._gridElement):this._gridAdapter.hideFilters(this._gridElement)},_.prototype._initializeSortDialog=function(){if(this._supportsMultiColumnSort){var e=this;this.closeSortDialog=function(){e._closeSortDialog()},this.executeSortDialog=function(){e._executeSortDialog()},this.sortCriteria=[];for(var i=0;i<_.SORTS_LIMIT;i++)this.sortCriteria.push({label:0===i?this.sortByFirstLabel:this.sortByLaterLabel,column:t.observable(),direction:t.observable("asc")});this.sortableColumns=this._gridAdapter.getSortableColumns(this._gridElement,this._columnDefs),this.renderSorting=this.sortableColumns.length>0,this.sortableColumnsDataProvider=new c(this.sortableColumns,{keyAttributes:"value"})}else this.renderSorting=!1},_.prototype._openSortDialog=function(){this._applySortCriteria(this._gridAdapter.getSortCriteria(this._gridElement)),document.getElementById(this.sortDialogId).open()},_.prototype._applySortCriteria=function(t){for(var e=Math.min(t.length,_.SORTS_LIMIT),i=0;i<e;i++){var n=t[i],o=this.sortCriteria[i];o.column(n.column),o.direction(n.direction)}for(i=e;i<this.sortCriteria.length;i++)this.sortCriteria[i].column(null),this.sortCriteria[i].direction("asc")},_.prototype._closeSortDialog=function(){document.getElementById(this.sortDialogId).close()},_.prototype._executeSortDialog=function(){var t=this._getSortCriteria();this._gridAdapter.executeSort(this._gridElement,t),this._closeSortDialog()},_.prototype._getSortCriteria=function(){for(var t=[],e=this.sortCriteria,i=0;i<e.length;){var n=e[i].column(),o=e[i].direction();n&&t.push({column:n,direction:o}),i++}return t},_.prototype._openManageColumnsDialog=function(){document.getElementById(this.columnManagementDialogId).open()},_.prototype._closeManageColumnsDialog=function(){document.getElementById(this.columnManagementDialogId).close()},_.prototype._beforeColumnManagementDialogOpen=function(){this._cancelColumnChanges=!0;var t=this._gridAdapter.getColumnConfiguration(this._gridElement,this._previousColMgmtConfig),e=this._getColumnManagementListItems(t);this._refreshColMgmtDataSource(e)},_.prototype._handleColumnManagementDialogClose=function(t){t.target.id===this.columnManagementDialogId&&(this._cancelColumnChanges&&(this._activeColMgmtListItems=this._getColumnManagementListItems(this._previousColMgmtConfig)),this._refreshColMgmtDataSource(this._activeColMgmtListItems))},_.prototype._resetColumnsToDefaults=function(){var t=this._getColumnManagementListItems(this._columnDefs);this._updateActiveColMgmtDataSource(t)},_.prototype._applyColumnChanges=function(){this._cancelColumnChanges=!1,this._applyColumnConfigurationToGrid(this._activeColMgmtListItems),this._closeManageColumnsDialog()},_.prototype._handleColumnReorder=function(t){for(var e=this,i=function(t){e._handleColumnMoveSuccess(t)},n=document.getElementById(this.columnManagementListViewId),o=n.getContextByNode(t.detail.reference),a=t.detail.items,r=0;r<a.length;r++){var s,l=n.getContextByNode(a[r]);r===a.length-1&&(s={success:i}),this.columnManagementDataSource().move(l.key,o.key,t.detail.position,s)}},_.prototype._handleColumnMoveSuccess=function(t){var e=document.getElementById(this.columnManagementListViewId),i=t.children;1===i.length&&(this._activeColMgmtListItems=this._getActiveColMgmtListItems(i[0].children)),e.refresh();var n=this,o=e.currentItem;this._performActionWhenReady(this.columnManagementListViewId,(function(){e.currentItem=o,document.getElementById(n.columnManagementListViewId).focus()}))},_.prototype._getActiveColMgmtListItems=function(t){return t.map((function(t){return{attr:{id:t.attr.id,value:t.attr.value,label:t.attr.label,shown:t.attr.shown}}}),this)},_.prototype._applyColumnConfigurationToGrid=function(t){var e=this._getColumnConfiguration(t);this._gridAdapter.applyColumnConfiguration(this._gridElement,e)},_.prototype._initializeMenus=function(t){this._initializeActionMenu(t),this._initializeViewMenu(),this.renderQBE&&this._initializeFilterMenu()},_.prototype._initializeActionMenu=function(t){var e=this,i=this._standardActionsMenu.length>0,n=t||[],o=n.length>0;if(this.renderActionMenu=i||o,this.renderActionMenu){var a=i&&o?[{separator:!0}]:[],r=this._standardActionsMenu.concat(a,n);this.actionMenuItems=this._parseMenu(this.actionMenuId,r),this.actionMenuSelect=function(t){e._handleMenuSelect(e.actionMenuItems,t.target)}}},_.prototype._initializeViewMenu=function(){var e=this,i=[];this.renderColumnManagement&&i.push({label:this.manageColumnsLabel,callback:function(){e._openManageColumnsDialog()}}),i.push({label:this.detachMenuItemLabel,callback:function(){e._toggleDetachTable()}}),this._renderColumnBasedOptions&&this.renderSorting&&i.push({label:this.sortMenuLabel,callback:function(){e._openSortDialog()}}),this.renderQBE&&i.push({label:this.queryLabel,callback:function(){e._toggleQBE()},ariaLabel:t.pureComputed((function(){return this._filtersEnabled()?this.enabled:""}),this),selected:t.pureComputed((function(){return{"oj-menu-item-icon":this._filtersEnabled(),"oj-rgbu-jraf-apps-table-checked-icon":this._filtersEnabled()}}),this)}),this.viewMenuItems=this._parseMenu(this.viewMenuId,i),this.viewMenuSelect=function(t){e._handleMenuSelect(e.viewMenuItems,t.target)},this.viewMenuAnimateListener=function(t){e._handleViewMenuAnimation(t)}},_.prototype._parseMenu=function(t,e){if(!e||!e.length)return null;for(var i=[],n=0;n<e.length;n++){var o=t+_.MENU_VALUE_SEPARATOR+(n+1),a={id:o,label:e[n].label,callback:e[n].callback,icon:e[n].icon,disabled:e[n].disabled,ariaLabel:e[n].ariaLabel,selected:e[n].selected,separator:e[n].separator,children:this._parseMenu(o,e[n].children)};i.push(a)}return i},_.prototype._handleMenuSelect=function(t,e){var i=e.value.split(_.MENU_VALUE_SEPARATOR),n=i.length>2,o=t[parseInt(i[1],10)-1];(n?o.children[parseInt(i[2],10)-1]:o).callback(e)},_.prototype._handleViewMenuAnimation=function(t){"close"===t.detail.action&&(t.preventDefault(),r.fadeOut(t.detail.element,{duration:"200ms"}).then(t.detail.endCallback))},_.prototype._initializeFilterMenu=function(){var e=this;this.filterMatchOptionsShown=this._context.properties.filterMatchOptionsShown,this.filterMatchType=t.observable(this._gridAdapter.getFilterMatchType(this._gridElement)),this.filterMenuSelect=function(t){e._handleFilterMenuSelect(t)}},_.prototype._handleFilterMenuSelect=function(t){var e=t.target.value;e===_.FILTER_MENU_OPTIONS_CLEAR_FILTER?this._gridAdapter.clearFilters(this._gridElement):e===_.FILTER_MENU_OPTIONS_MATCH_TYPE_AND?(this.filterMatchType(_.FILTER_MATCH_TYPE_AND),this._gridAdapter.setFilterMatchType(this._gridElement,_.FILTER_MATCH_TYPE_AND)):e===_.FILTER_MENU_OPTIONS_MATCH_TYPE_OR&&(this.filterMatchType(_.FILTER_MATCH_TYPE_OR),this._gridAdapter.setFilterMatchType(this._gridElement,_.FILTER_MATCH_TYPE_OR))},_.prototype._initializeStandardActions=function(t,e){this.createIcon={"oj-icon":!0,"oj-rgbu-jraf-apps-table-create-icon":!t,"oj-rgbu-jraf-apps-table-add-icon":t};var i={hadCrudAction:!1,hadOtherStandardAction:!1,addedActionsMenuSeparator:!1};this._standardActionsMenu=[],_.STANDARD_ACTIONS.forEach((function(t){this._initializeStandardAction(t,e,i)}),this),this.hasCrud=!!i.hadCrudAction,this._initializeExportFunctionality(e),this._initializeFilters(),this._initializeDetach(),this.hasOtherStandardActions=!(!(this.handleRefresh||this.renderExportButton||this.renderQBE)&&e.hideDetachButton)},_.prototype._initializeStandardAction=function(e,i,n){var o="handle"+e;if(this[o]="function"==typeof i[o]&&i[o],"Refresh"!==e&&"Export"!==e?n.hadCrudAction=n.hadCrudAction||this[o]:n.hadOtherStandardAction=n.hadOtherStandardAction||this[o],n.hadCrudAction&&n.hadOtherStandardAction&&!n.addedActionsMenuSeparator&&(this._standardActionsMenu.push({separator:!0}),n.addedActionsMenuSeparator=!0),this[o]){var a="disable"+e,r=e.toLowerCase()+"ButtonLabel";this[a]=t.observable(i[a]||!1),this._standardActionsMenu.push({disabled:this[a],label:this[r],callback:this[o]})}},_.prototype._initializeExportFunctionality=function(t){var e=this;this._enableDefaultExport=t.enableDefaultExport;var i=this._enableDefaultExport&&this._supportsExportToExcel;return this.renderExportButton=i||this.handleExport,this.renderExportMenu=i&&this.handleExport,this.renderExportMenu?(this.exportMenuItems=this._getExportMenu(),this.exportMenuSelect=function(t){e._handleMenuSelect(e.exportMenuItems,t.target)},void this._updateExportActionMenuItem(void 0,this.exportMenuItems)):this.renderExportButton?(this.invokeExportHandler=function(){e.handleExport?e.handleExport():e._invokeGridExport()},void this._updateExportActionMenuItem(this.invokeExportHandler)):void 0},_.prototype._updateExportActionMenuItem=function(t,e){var i=this._standardActionsMenu.filter((function(t){return t.label===this.exportButtonLabel}),this);1===i.length&&(i[0].callback=t,i[0].children=e)},_.prototype._getExportMenu=function(){var t=this;return this._parseMenu(this.exportMenuId,[{label:this.exportVisible,callback:function(){t._invokeGridExport()}},{label:this.exportAll,callback:function(){t.handleExport()}}])},_.prototype._invokeGridExport=function(){this._gridAdapter.exportToExcel(this._gridElement)},_.prototype._initializeCustomButtons=function(t){this.customButtons=t.extraButtons?this._parseCustomButtons(t.extraButtons):[],this.hasCustomButtons=this.customButtons.length>0},_.prototype._initializeExtraControls=function(){this.hasExtraControls=this._context.slotCounts.extraControls>0},_.prototype._parseCustomButtons=function(t){for(var e=[],i=0;i<t.length;i++)e.push(this._createButton(t[i]));return e},_.prototype._createButton=function(e){return{label:e.label,startIcon:e.icon?"oj-icon "+e.icon:"",display:e.iconOnly?"icons":"all",disabled:"boolean"==typeof t.unwrap(e.disabled)&&e.disabled,buttonHandler:e.buttonHandler}},_.prototype._setupToolbarRefresh=function(){this._getChangeableToolbarObjectProps().filter(this._filterChangeableToolbarObjectProps,this).forEach(this._subscribeToToolbarObjectChanges,this)},_.prototype._getChangeableToolbarObjectProps=function(){var t=this._getChangeableBuiltInButtonProps();return this.renderActionMenu&&(t=t.concat(this._getPropsFromChangeableToolbarObjects("actionMenuItems"))),this.hasCustomButtons&&(t=t.concat(this._getPropsFromChangeableToolbarObjects("customButtons"))),t},_.prototype._getChangeableBuiltInButtonProps=function(){return _.CHANGEABLE_PROPERTIES.map((function(t){return this[t]}),this)},_.prototype._getPropsFromChangeableToolbarObjects=function(t){return this[t].map((function(t){return t.disabled}))},_.prototype._filterChangeableToolbarObjectProps=function(e){return t.isObservable(e)},_.prototype._subscribeToToolbarObjectChanges=function(t){var e=this;t.subscribe((function(){e._refreshToolbar()}))},_.prototype._refreshToolbar=function(){document.getElementById(this.toolbarId).refresh()},_.prototype.propertyChanged=function(t){var e=t.property;"external"===t.updatedFrom&&_.CHANGEABLE_PROPERTIES.indexOf(e)>=0&&this[e](t.value)},_}));