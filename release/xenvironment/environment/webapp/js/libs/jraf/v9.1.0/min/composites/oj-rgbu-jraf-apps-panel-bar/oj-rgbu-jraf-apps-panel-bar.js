define(["knockout","jquery","ojs/ojlogger","jraf/utils/ValidationUtils","jraf/composites/utils/TranslationLoaderUtil","module","ojs/ojtoolbar","ojs/ojbutton","ojs/ojmenu","ojs/ojconveyorbelt"],(function(t,n,i,o,s,e){"use strict";function a(t){var n=this,i=t.uniqueId;this.p=i+"_menu",this.b=1,this.v={},this.m={},this.panelBarItems=[],this.g=1,this.B=i+"_button",this.loadingTranslations=a.y.getTranslations(),this.handleMenuOptionSelect=function(t){n._(t)},this.handleButtonClick=function(t){n.A(t)},this.componentInitializing=Promise.all([this.loadingTranslations,t.properties,t.slotCounts]).then((function(t){n.translations=t[0],n.M(t[1]),n.P(t[2]),n.k(),n.x()}))}return a.SUPPORTED_CHROME=["solid","borderless","outlined","full","half"],a.DEFAULT_CHROME="solid",a.SUPPORTED_BUTTON_SIZES={small:"oj-button-sm",large:"oj-button-lg",xl:"oj-button-xl"},a.NAVIGATION_ICON_NEXT="oj-rgbu-jraf-apps-panel-bar-icon oj-rgbu-jraf-apps-panel-bar-next-icon",a.NAVIGATION_ICON_PREV="oj-rgbu-jraf-apps-panel-bar-icon oj-rgbu-jraf-apps-panel-bar-prev-icon",a.y=new s("oj-rgbu-jraf-apps-panel-bar",e.id),a.prototype.activated=function(){return this.componentInitializing},a.prototype.bindingsApplied=function(){this.q()},a.prototype.M=function(n){this.buttonSize=this.O(n.buttonSize),this.S=this.C(n.mainActionChroming),this.mainActionButtons=this.D(n.mainActionButtons,this.S),0<this.mainActionButtons.length&&!this.mainActionButtons[0].isMenu&&(this.mainActionButtons[0].chrome="callToAction"),this.I=this.C(n.navigationChroming),this.nextButton=null,this.prevButton=null,o.isFunction(n.nextCallback)&&(this.nextButton=this.T({label:this.translations.nextLabel,callback:n.nextCallback,iconOnly:n.navigationIconOnly,icon:a.NAVIGATION_ICON_NEXT,disabled:t.observable(n.nextDisabled),shortcut:n.nextShortcut},this.I),this.nextButton&&(this.nextButton.iconEnd=!0)),o.isFunction(n.prevCallback)&&(this.prevButton=this.T({label:this.translations.previousLabel,callback:n.prevCallback,iconOnly:n.navigationIconOnly,icon:a.NAVIGATION_ICON_PREV,disabled:t.observable(n.prevDisabled),shortcut:n.prevShortcut},this.I)),this.U=this.C(n.extraActionChroming),this.extraActionButtons=this.D(n.extraActionButtons,this.U)},a.prototype.D=function(t,n){var i=[];if(!o.isArray(t))return i;for(var s=0;s<t.length;s++){var e,a=t[s];(e=o.isArray(a.options)?this.V(a,n):this.T(a,n))&&i.push(e)}return i},a.prototype.T=function(t,n){if(!o.isObjectStrict(t)||!o.isFunction(t.callback))return i.warn("AppsPanelBar._parseButton: Missing required parameters for button"),null;var s=this.w(t,n);return s.isMenu=!1,s.isSeparator=!1,s.callback=t.callback,this.m[s.id]=s},a.prototype.V=function(t,n){if(!o.isObjectStrict(t)||!o.isArray(t.options)||0===t.options.length)return i.warn("AppsPanelBar._parseMenuButton: Menu has no options"),null;var s=this.w(t,n);return s.isMenu=!0,s.isSeparator=!1,s.menuId=this.p+this.b,s.options=this.z(t.options,s.menuId),this.b++,s},a.prototype.w=function(n,s){var e=o.getBoolean(n.iconOnly,!1),a=o.isNonemptyString(n.icon)?n.icon:null,r=!o.isBoolean(t.unwrap(n.displayed))||n.displayed;return!t.isObservable(n.label)&&!o.isNonemptyString(n.label)||e&&!a?(i.warn("AppsPanelBar._parseButtonCore: Missing required parameters for button"),null):{id:this.B+"-"+this.g++,label:n.label,icon:a,display:e?"icons":"all",displayed:r,disabled:n.disabled,shortcut:this.L(n.shortcut),chrome:s,size:this.buttonSize}},a.prototype.z=function(n,s){for(var e=[],a=0;a<n.length;a++){var r=n[a],l=!o.isBoolean(t.unwrap(r.displayed))||r.displayed;if((t.isObservable(r.label)||o.isNonemptyString(r.label))&&o.isFunction(r.callback)){var p={label:r.label,icon:r.icon,callback:r.callback,disabled:r.disabled,displayed:l,optionId:s+"-"+a};e.push(p),this.v[p.optionId]=p}else i.warn("AppsPanelBar._parseMenuOptions: Missing required parameters for menu option")}return e},a.prototype.C=function(t){return a.SUPPORTED_CHROME.indexOf(t)<0?(i.warn("AppsPanelBar._getChromingValue: Invalid chrome "+t),a.DEFAULT_CHROME):t},a.prototype.O=function(t){return a.SUPPORTED_BUTTON_SIZES[t]||""},a.prototype.L=function(t){return!o.isNonemptyString(t)||1<t.length?null:t},a.prototype.P=function(t){this.F=!!t.customContent},a.prototype.k=function(){var t=0<this.mainActionButtons.length,n=this.prevButton||this.nextButton,i=0<this.extraActionButtons.length;this.showNavDivider=t&&n,this.showExtraDivider=(t||n)&&i,this.showSlotDivider=(t||n||i)&&this.F},a.prototype.x=function(){this.panelBarItems=this.panelBarItems.concat(this.mainActionButtons),this.showNavDivider&&this.panelBarItems.push({isSeparator:!0}),this.nextButton&&(this.panelBarItems=this.panelBarItems.concat(this.nextButton)),this.prevButton&&(this.panelBarItems=this.panelBarItems.concat(this.prevButton)),this.showExtraDivider&&this.panelBarItems.push({isSeparator:!0}),this.panelBarItems=this.panelBarItems.concat(this.extraActionButtons),this.showSlotDivider&&this.panelBarItems.push({isSeparator:!0})},a.prototype._=function(t){var n=t.target.id,i=this.v[n];i.callback(i,t)},a.prototype.A=function(t){var n=t.target.id,i=this.m[n];i.callback(i,t)},a.prototype.q=function(){var n=this.mainActionButtons[0];n&&t.unwrap(n.displayed)&&document.getElementById(n.id).scrollIntoView()},a.prototype.propertyChanged=function(t){var n=t.property;"external"===t.updatedFrom&&("nextDisabled"===n&&this.nextButton?this.nextButton.disabled(t.value):"prevDisabled"===n&&this.prevButton&&this.prevButton.disabled(t.value))},a}));