define(["knockout","ojs/ojcore","jraf/jrafcore","jraf/services/ServiceManager","jraf/models/UIShellManager","jraf/models/ProcessingIndicatorManager"],(function(i,o,a,t,n,e){"use strict";function r(){this.$a(),this.Qa()}return r.COLOR_REGEX=/^#[\da-f]{3}([\da-f]{3})?$/i,r.prototype.$a=function(){this.processingIndicatorManager=new e,n.RegisterProcessingIndicatorManager(this.processingIndicatorManager)},r.prototype.Qa=function(){var o=this;this.configLoaded=i.observable(!1);var e=a.App.getGlobalHeaderConfig();if(this.Wa(e),a.App.isAuthenticated())if(this.configInitialized())this.Xa();else{n.startProcessingIndicator();var r=t.getGlobalAreaConfigurationService();if(r)return r.getGlobalAreaConfigurations().then((function(i){o.Ya(i)}),(function(i){o.Za(i)}));n.stopProcessingIndicator(),this.configInitialized(!0),this.configLoaded(!0)}else this.configLoaded(!0)},r.prototype.Xa=function(){this.configLoaded(!0)},r.prototype.Wa=function(i){this.processingIndicatorColor=i.processingIndicatorColor,this.applicationIcon=i.applicationIcon,this.applicationName=i.applicationName,this.nh=i.maxLogoSize,this.configInitialized=i.initialized},r.prototype.Ya=function(i){if(r.COLOR_REGEX.test(i.processingIndicatorColor)&&this.processingIndicatorColor(i.processingIndicatorColor),i.logo){var o=i.logo,a=this.ah(o);this.applicationIcon(a)}i.applicationName&&this.applicationName(i.applicationName),i.maxLogoSize&&this.nh(i.maxLogoSize),n.stopProcessingIndicator(),this.configInitialized(!0),this.configLoaded(!0)},r.prototype.ah=function(i){var o=i.substring(0,20);return 0===window.atob(o).indexOf("<?xml")?"data:image/svg+xml;base64,"+i:"data:image/png;base64,"+i},r.prototype.Za=function(i){o.Logger.warn("HeaderState._handleLoadConfigFailure: failed loading data with reason "+i),n.stopProcessingIndicator(),this.configInitialized(!0),this.configLoaded(!0)},r}));