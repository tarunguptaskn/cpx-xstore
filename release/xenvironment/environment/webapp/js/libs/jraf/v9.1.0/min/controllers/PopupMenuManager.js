define(["ojs/ojcore","knockout","jquery","jraf/utils/ValidationUtils"],(function(e,n,t,o){"use strict";function i(e){if(!(o.isObjectStrict(e)&&o.isNonemptyString(e.popupId)&&n.isObservable(e.selectedMenuItemId)&&n.isObservable(e.activeMenuModuleBinding)))throw new TypeError("PopupMenuManager: Invalid menu configuration.");this.menuPopupId=e.popupId,this.selectedMenuItemId=e.selectedMenuItemId,this.activeMenuModuleBinding=e.activeMenuModuleBinding,this.renderedMenuLauncherId=null,this.Oo=n.observable(!1),this.Vo()}return i.prototype.Vo=function(){var n=this,t=this.Jo();t.onOjBeforeClose=function(){e.Logger.info("PopupMenuManager: Entering ojBeforeClose event handler."),n.Ko(),n.Oo(!1)},t.onOjOpen=function(){n.Oo(!0)}},i.prototype.Jo=function(){return document.getElementById(this.menuPopupId)},i.prototype.Ko=function(){this.selectedMenuItemId()&&this.selectedMenuItemId(null)},i.prototype.Qo=function(e){return t("#"+e).get(0)},i.prototype.Ro=function(e){var n=this.Qo(e);this.Jo().open(n,{at:{horizontal:"start",vertical:"bottom"},my:{horizontal:"start",vertical:"top"},collision:"fit"})},i.prototype.Wo=function(){this.Jo().close()},i.prototype.openMenu=function(n){if(!o.isObjectStrict(n)||!o.isNonemptyString(n.launcherId)||!o.isObjectStrict(n.moduleBinding))throw new TypeError("PopupMenuManager.openMenu: Invalid input.");var t=n.launcherId;e.Logger.info("PopupMenuManager.openMenu: Opening popup menu for launcher %s.",t),this.renderedMenuLauncherId!==t&&(e.Logger.info("PopupMenuManager.openMenu: new launcherId passed, so updating activeMenuModuleBinding."),this.renderedMenuLauncherId=t,this.activeMenuModuleBinding(n.moduleBinding)),this.Ro(n.launcherId)},i.prototype.closeMenu=function(){e.Logger.info("PopupMenuManager.closeMenu: Closing popup menu: %s",this.selectedMenuItemId()),this.Wo(),this.Ko()},i.prototype.getMenuState=function(){return n.pureComputed((function(){return this.Oo()}),this)},i.prototype.resetMenu=function(){this.Ko(),this.activeMenuModuleBinding(null)},i}));