define(["knockout","ojs/ojcore","jquery","jraf/jrafcore","jraf/models/UIShellManager","jraf/services/ServiceManager","jraf/utils/ValidationUtils","ojs/ojnavigationlist","ojs/ojarraytabledatasource"],(function(t,e,i,a,n,r,o){"use strict";var s=e.Translations.getTranslatedString;function c(t){var e=this;this.navMenuId=a.UIShell.generateUniqueId(),this.appListDescription=s("jraf.sidebar.appListDescription"),this.loadingText=s("jraf.messages.loading"),this.currentSelectionLabel=s("jraf.common.currentSelectionLabel"),this.Mc=a.App.getApplicationName(),this.Oc=o.isObjectStrict(t)&&o.isFunction(t.launchApplicationCallback)?t.launchApplicationCallback:null,this.layout=o.isObjectStrict(t)&&o.isString(t.layout)?t.layout:"",this.getAppListHeight=function(){var t="";return"horizontal"!==e.layout&&(void 0===(t=i(".jraf-global-header-wrapper").outerHeight(!0))&&(t=i(".jraf-mobile-nav-header").outerHeight(!0)),t="calc(100vh - "+(t+=i(".jraf-menu-header-text").outerHeight(!0))+"px)"),t},this.Qc(),this.beforeSelect=function(t,i){e.Wc(t,i)}}return c.prototype.Qc=function(){this.menuDataLoaded=t.observable(),this.Xc={},this.navData=t.observableArray([]),this.navDataSource=new e.ArrayTableDataSource(this.navData,{idAttribute:"domId"}),this.Yc=r.getAppNavigatorService(),this.Zc()},c.prototype.Zc=function(){var t=this;return this.menuDataLoaded(!1),n.startProcessingIndicator(),this.Yc.loadNavigation().then((function(e){t.$c(e)}),(function(e){t.Lf(e)}))},c.prototype.$c=function(t){var e=this,i=0,a=this.navMenuId+"-entry-",r=t.filter((function(t){return!t.systemEntry})).map((function(t){return e.zf(t,a+i++)}));r.unshift(this.Af(a+i)),this.navData(r),this.menuDataLoaded(!0),n.stopProcessingIndicator()},c.prototype.zf=function(t,e){var i={label:t.name,domId:e,url:t.url,selected:!1};return this.Xc[i.domId]=i},c.prototype.Af=function(t){return{label:this.Mc,domId:t,url:null,selected:!0}},c.prototype.Lf=function(t){n.stopProcessingIndicator(),e.Logger.warn("NavigatorMenuBody._handleMenuLoadFailure: Failed to load app navigation data: ",t)},c.prototype.Wc=function(t,e){t.preventDefault();var i=this.Xc[t.detail.key],a=i.url;return i.selected||(this.Oc&&this.Gf(a)?this.Oc(a):window.open(a,"_blank")),!1},c.prototype.Gf=function(t){return this.Hf(window.location.href)===this.Hf(t)},c.prototype.Hf=function(t){var e=t.indexOf("://");e=0<=e?e+3:0;var i=[t.indexOf("#"),t.indexOf("?"),t.indexOf("/",e)].filter((function(t){return 0<=t})).reduce((function(t,e){return Math.min(t,e)}),t.length);return t.substring(0,i)},c}));