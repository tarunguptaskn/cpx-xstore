define(["ojs/ojcore","knockout","jquery","jraf/jrafcore","jraf/models/UIShellConfig","jraf/models/Content","jraf/models/UIShellManager","jraf/models/PopupManager","jraf/models/MenuManager","jraf/controllers/PopupMenuManager","jraf/controllers/LayoutManager","jraf/controllers/MobileMenuManager","jraf/models/MenuContents","jraf/utils/ValidationUtils","jraf/utils/UrlUtils","jraf/models/TabStateService","jraf/models/TabState","jraf/models/HeaderMenus","jraf/models/HeaderState","jraf/services/ServiceManager","jraf/models/notifications/NotificationsConfig","jraf/controllers/notifications/NotificationHandler","jraf/models/favorites/FavoritesConfig","jraf/controllers/favorites/FavoriteHandler","jraf/models/ModalPageManager","jraf/controllers/PollingManager","jraf/utils/RouterUtils","ojs/ojanimation","ojs/ojdialog","ojs/ojpopup","ojs/ojmodule","ojs/ojrouter","ojs/ojknockout","ojs/ojcomposite","jraf/composites/oj-rgbu-jraf-message-dialog/loader","jraf/composites/oj-rgbu-jraf-modal-page/loader","jraf/composites/oj-rgbu-jraf-apps-module/loader"],(function(e,t,n,o,i,a,r,l,s,u,d,c,g,p,h,f,M,C,b,m,_,I,v,S,y,L,N,j){"use strict";var P=e.Translations.getTranslatedString;function A(n){e.Logger.info("UIShellPage: entering constructor function.");var a=n&&n.routerState?n.routerState.detail.params:n;if(!(a instanceof i))throw new TypeError("UIShellPage: config was not UIShellConfig.");r.ActivateNewManager(a);var l=a.getNavigationConfig();this.layoutManager=d.getInstance(l),this.hasSidebarLayoutSupport=this.layoutManager.hasSidebarLayoutSupport(),this.hasHorizontalBarLayoutSupport=this.layoutManager.hasHorizontalBarLayoutSupport(),this.mainAreaId=o.UIShell.generateUniqueId(),this.menuDrawerId=o.UIShell.generateUniqueId(),this.popupComponentId=o.UIShell.generateUniqueId(),this.popupAppsModuleId=o.UIShell.generateUniqueId(),this.errorDialogId=o.UIShell.generateUniqueId(),this.additionalOptionsDrawerId=o.UIShell.generateUniqueId(),this.mobileSearchPopupId=o.UIShell.generateUniqueId(),this.mobileNavigationDrawerId=o.UIShell.generateUniqueId(),this.globalModalPageContainerId=o.UIShell.generateUniqueId(),this.errorMessage=t.observable(),this.activeMenuModuleBinding=null,this._initializeMenuConfig(a);var s=a.getHeaderConfig();this._headerState=new b,this._initializeHeaderMenus(s),this._initializeGlobalHeader(s),this._initializeGlobalSidebar(l),this._initializeGlobalNavigationBar(l),this._initializeGlobalMainArea(a),this._initializePopupManager(a),this._initializeModalPageManager(a),this._layoutMonitor=e.ResponsiveKnockoutUtils.createScreenRangeObservable(),this._initializeMobileLayout(a),this._initializeMobileLayoutDetection(),this._initializeLogoutPrompt(s),l.hasNavigation()&&(this._setupNotificationConfig(l),this._setupFavoritesConfig(l),this._loadUIShellContent(l.getDefaultContentCallbacks()),this._initializeBadgeValuePolling(l)),this._menuManagerInitialized=!1}return A.prototype._setupNotificationConfig=function(e){if(e.hasNotificationsEnabled()){_.reset();var t=_.getInstance();t.setReassignNotificationSupport(e.getRenderNotificationReassignment()),t.registerNotificationHandler(_.DEFAULT_HANDLER_KEY,new I({serviceKey:m.NOTIFICATIONS_SERVICE_NAME}))}},A.prototype._setupFavoritesConfig=function(e){e.hasFavoritesEnabled()&&(v.reset(),v.getInstance().registerFavoriteHandler(v.DEFAULT_HANDLER_KEY,new S({serviceKey:m.FAVORITES_SERVICE_NAME,displayFavoriteTitleInTab:e.isDisplayFavoriteTitleInTab()})))},A.prototype.connected=function(){e.Logger.info("UIShellPage.connected: Entering."),this._beginPolling(),this._initializeMobileLayoutDetection()},A.prototype.disconnected=function(){e.Logger.info("UIShellPage.disconnected: Entering."),this._endPolling(),this._cleanupMobileLayoutDetection()},A.prototype.transitionCompleted=function(){e.Logger.info("UIShellPage.transitionCompleted: Entering."),this._initializeMenuManager()},A.prototype.dispose=function(){e.Logger.info("UIShellPage.dispose: Entering."),this._endPolling(),this._cleanupMobileLayoutDetection()},A.prototype._initializeMobileLayoutDetection=function(){var n=this;this.isMobileLayout&&this.isMobileLayout.isActive()||(this.isMobileLayout=t.pureComputed((function(){return this._layoutMonitor()===e.ResponsiveUtils.SCREEN_RANGE.SM}),this),this.isMobileLayout.subscribe((function(e){r.closeAllMenus(),e||n._closeMobileSearch()})))},A.prototype._cleanupMobileLayoutDetection=function(){this.isMobileLayout&&this.isMobileLayout.isActive()&&this.isMobileLayout.dispose()},A.prototype._initializeLogoutPrompt=function(e){var n=this;this.confirmLogoutId=o.UIShell.generateUniqueId(),this.confirmLogoutDefaultText=P("jraf.messages.confirmLogout"),this.confirmLogoutNoChangeText=P("jraf.messages.confirmLogoutUnchanged"),this.confirmLogoutText=t.observable(this.confirmLogoutDefaultText),this._logoutCallback=e.getLogoutCallback(),this.logoutUser=function(){n._handleApplicationLogout()},this.unsavedChangesCallback=e.getUnsavedChangesCallback()},A.prototype._initializeMenuConfig=function(e){this.hasSidebarLayoutSupport&&this._initializeOffcanvasMenuConfig(e),this.hasHorizontalBarLayoutSupport&&this._initializePopupMenuConfig()},A.prototype._initializeOffcanvasMenuConfig=function(e){var n=t.observable(!1);this.readOnlyMenuOpened=t.pureComputed((function(){return n()}));var o=t.observable(!1);this.readOnlyMenuPinned=t.pureComputed((function(){return o()}));var i=e.getNavigationConfig(),a=i.getDefaultMenuItem(),r=a.getId(),l=t.observable(r);this.readOnlySelectedMenuId=t.pureComputed((function(){return l()}));var s=t.observable(a.getSidebarMenuModuleBinding());this.menuLoading=t.observable(!0),this._loadedModules=[],this.activeMenuModuleBinding=t.pureComputed((function(){return this._getActiveMenuModuleBinding(s)}),this),this.menuConfiguration={drawerId:this.menuDrawerId,appContentContainerId:this.mainAreaId,opened:n,pinned:o,selectedMenuItemId:l,activeMenuModuleBinding:s,menuItems:i.getMenuItems(),contentAreaResizedCallback:e.getContentAreaResizedCallback()}},A.prototype._getActiveMenuModuleBinding=function(e){var t=e();return p.isObjectStrict(t)&&this._loadedModules.indexOf(t.cacheKey)<0&&(this._addMenuLoadingCallbacks(t,this.menuLoading),this._loadedModules.push(t.cacheKey)),t},A.prototype._initializePopupMenuConfig=function(){this.popupMenuContainerId=o.UIShell.generateUniqueId(),this.selectedPopupMenuItemId=t.observable(null);var e=t.observable(null);this.activePopupMenuModuleBinding=t.pureComputed((function(){return e()}),this),this.popupMenuConfiguration={popupId:this.popupMenuContainerId,selectedMenuItemId:this.selectedPopupMenuItemId,activeMenuModuleBinding:e},this.cancelAnimation=function(e,t){return e.preventDefault(),e.detail.endCallback(),!1}},A.prototype._addMenuLoadingCallbacks=function(e,t){var n,o,i=e.lifecycleListener;i?(n=i.transitionCompleted,o=i.activated):(i={},e.lifecycleListener=i),i.transitionCompleted=function(){t(!1),p.isFunction(n)&&n.apply(this,arguments)},i.activated=function(){t(!0),p.isFunction(o)&&o.apply(this,arguments)}},A.prototype._initializeHeaderMenus=function(e){var t=this;if(e.isRenderGlobalMenuArea()){var n={preferencesCallback:e.getPreferencesCallback(),preferencesMenuConfig:e.getPreferencesMenuConfig(),userDataCallback:e.getUserDataCallback(),applicationHelpCallback:e.getApplicationHelpCallback(),helpMenuConfig:e.getHelpMenuConfig(),aboutCallback:e.getAboutCallback(),customMenuConfig:e.getCustomMenuConfig(),logoutCallback:p.isFunction(e.getLogoutCallback())?function(){t._openConfirmLogoutDialog()}:void 0};this._headerMenuModel=new C(n)}},A.prototype._initializeGlobalHeader=function(e){var t=this.hasSidebarLayoutSupport,n=e.isRenderGlobalMenuArea(),o=e.isRenderApplicationName(),i=e.isRenderProcessingIndicator(),a={supportsMenuPin:t,renderMenuPin:this.layoutManager.getRenderMenuPin(),renderGlobalMenuArea:n,renderApplicationName:o,renderProcessingIndicator:i,headerState:this._headerState};if(t&&(a.pinned=this.readOnlyMenuPinned),n){a.headerMenus=this._headerMenuModel;var r=e.getGlobalSearchConfig();r&&(a.globalSearchCallback=r.getGlobalSearchCallback(),a.globalSearchSectionFilterCallback=r.getGlobalSearchSectionFilterCallback(),a.globalSearchContextCallback=r.getGlobalSearchContextCallback(),a.globalSearchAllResultsCallback=r.getGlobalSearchAllResultsCallback())}this.globalHeaderModuleOptions={name:"jraf/UIShellGlobalHeader",params:a}},A.prototype._initializeGlobalSidebar=function(e){this.renderSidebarArea=this.layoutManager.getRenderSidebarMenu(),this.hasSidebarLayoutSupport&&(this.globalSidebarModuleOptions={name:"jraf/UIShellGlobalSidebar",params:{opened:this.readOnlyMenuOpened,selectedMenuItemId:this.readOnlySelectedMenuId,menuItems:this.menuConfiguration.menuItems,pinnedFavoritesEnabled:e.hasPinnedFavoritesEnabled()}})},A.prototype._initializeGlobalNavigationBar=function(e){if(this.renderNavigationBar=this.layoutManager.getRenderHorizontalBarMenu(),this.hasHorizontalBarLayoutSupport){var t={menuItems:e.getMenuItems(),menuContainerId:this.popupMenuContainerId,selectedMenuItemId:this.selectedPopupMenuItemId,pinnedFavoritesEnabled:e.hasPinnedFavoritesEnabled()};this.globalNavigationBarModuleOptions={name:"jraf/UIShellNavigationBar",params:t}}},A.prototype._initializeGlobalMainArea=function(e){var t={useCustomContentArea:e.isUseCustomContentArea(),beforeLoadModuleHandler:e.getNavigationConfig().getBeforeLoadModuleHandler(),afterUnloadModuleHandler:e.getNavigationConfig().getAfterUnloadModuleHandler()};t.useCustomContentArea&&(t.customContentAreaModuleBinding=e.getCustomContentAreaModuleBinding(),t.customContentAreaModuleOptions=e.getCustomContentAreaModuleOptions()),this.globalMainAreaModuleOptions={name:"jraf/UIShellGlobalMainArea",params:t}},A.prototype._initializePopupManager=function(e){var t=new l({popupComponentId:"#"+this.popupComponentId,popupAppsModuleId:this.popupAppsModuleId});this.popupModuleBinding=t.getModuleBinding(),this.popupModuleOptions=t.getModuleOptions(),this.popupBeforeLoadModuleHandler=e.getNavigationConfig().getBeforeLoadModuleHandler(),this.popupAfterLoadModuleHandler=t.getAfterLoadModuleHandler(),this.popupTransitionEndHandler=t.getTransitionEndHandler(),this.popupAfterUnloadModuleHandler=e.getNavigationConfig().getAfterUnloadModuleHandler(),r.RegisterPopupManager(t)},A.prototype._initializeModalPageManager=function(e){var t=new y({modalPageContainerId:this.globalModalPageContainerId,beforeLoadModuleHandler:e.getNavigationConfig().getBeforeLoadModuleHandler(),afterUnloadModuleHandler:e.getNavigationConfig().getAfterUnloadModuleHandler()});r.RegisterGlobalModalPageManager(t)},A.prototype._initializeMobileLayout=function(e){var t=e.getNavigationConfig(),n=e.getHeaderConfig();this.supportsNavigation=this.hasSidebarLayoutSupport||this.hasHorizontalBarLayoutSupport,this._mobileMenuManager=new c({navMenuId:this.mobileNavigationDrawerId,optionsMenuId:this.additionalOptionsDrawerId,mainAreaId:this.mainAreaId}),r.RegisterMobileMenuManager(this._mobileMenuManager),this.additionalOptionsModuleOptions=null,this._initializeMobileSearchModule(n),this._initializeMobileNavigationMenu(t,n),this._initializeMobileHeader(e)},A.prototype._initializeMobileHeader=function(e){var o=this,i=e.getHeaderConfig(),a={headerState:this._headerState,renderContentTitle:i.isRenderContentTitleForMobileCustomContentArea()};if(a.renderContentTitle&&e.isUseCustomContentArea()){var r=e.getCustomContentAreaTitle();this._currentMobileContentTitle=t.observable(P(r)),a.currentContentTitle=t.pureComputed((function(){return o._currentMobileContentTitle()})),n(window.document).on("jrafcontentchange",(function(e,t){o._currentMobileContentTitle(t.title)}))}i.isRenderGlobalMenuArea()&&(a.openOptionsMenuCallback=function(){o._mobileMenuManager.openOptionsMenu()},this._initializeMobileOptionsMenu()),this.mobileSearchModuleOptions&&(a.openSearchCallback=function(){o._openMobileSearch()}),this.supportsNavigation&&(a.openNavigationCallback=function(){o._mobileMenuManager.openNavMenu()}),this.mobileHeaderModuleOptions={name:"jraf/mobile/UIShellMobileHeader",params:a}},A.prototype._initializeMobileOptionsMenu=function(){this.additionalOptionsModuleOptions={name:"jraf/mobile/AdditionalOptionsMenu",params:{menus:this._headerMenuModel}}},A.prototype._initializeMobileSearchModule=function(t){var n=this;this.mobileSearchModuleOptions=null;var o=t.getGlobalSearchConfig();if(o){var i={closeSearchCallback:function(){n._closeMobileSearch()}};if(i.searchCallback=o.getGlobalSearchCallback(),i.searchSectionFilterCallback=o.getGlobalSearchSectionFilterCallback(),i.searchContextCallback=o.getGlobalSearchContextCallback(),!p.isFunction(i.searchCallback)||!p.isFunction(i.searchSectionFilterCallback)||!p.isFunction(i.searchContextCallback))return void e.Logger.warn("UIShellPage._initializeMobileSearchModule: Incomplete search configuration provided. Unable to initialize module.");this.mobileSearchModuleOptions={name:"jraf/mobile/SearchPopup",params:i}}},A.prototype._initializeMobileNavigationMenu=function(e,t){this.supportsNavigation&&(this.mobileNavigationModuleOptions={name:"jraf/mobile/NavigationMenu",params:{menus:e.getMenuItems(),pinnedFavoritesEnabled:e.hasPinnedFavoritesEnabled(),renderApplicationIcon:t.isRenderContentTitleForMobileCustomContentArea(),headerState:this._headerState}})},A.prototype._openMobileSearch=function(){this.mobileSearchModuleOptions&&document.getElementById(this.mobileSearchPopupId).open(".jraf-global-bottom-content")},A.prototype._closeMobileSearch=function(){this.mobileSearchModuleOptions&&document.getElementById(this.mobileSearchPopupId).close()},A.prototype.handleBindingsApplied=function(t){e.Logger.info("UIShellPage.handleBindingsApplied: Entering."),this._initializeMenuManager(),this._initializeMobileLayoutDetection(),this._beginPolling()},A.prototype._initializeMenuManager=function(){if(!this._menuManagerInitialized){if(this.hasSidebarLayoutSupport){e.Logger.info("UIShellPage._initializeMenuManager: Supporting sidebar layout, so registering MenuManager.");var t=new s(this.menuConfiguration);r.RegisterMenuManager(t)}if(this.hasHorizontalBarLayoutSupport){e.Logger.info("UIShellPage._initializeMenuManager: Supporting horizontal bar layout, so registering PopupMenuManager.");var n=new u(this.popupMenuConfiguration);r.RegisterPopupMenuManager(n)}this._menuManagerInitialized=!0}},A.prototype._loadUIShellContent=function(t){e.Logger.info("UIShellPage._loadUIShellContent: Entering"),r.startProcessingIndicator(),this._menuContents=g.getInstance();var n=[];for(var o in t){var i=t[o],a=this._menuContents.registerMenuOptions(o,i);n.push(a)}this._attachDataPromiseHandlers(n)},A.prototype._attachDataPromiseHandlers=function(e){var t=this;Promise.all(e).then((function(e){g.getInstance().getContentLeaves().then((function(n){t._handleSuccessfulNavigationContentLoad(e,n)}))}),(function(e){t._handleFailedNavigationContentLoad(e)}))},A.prototype._handleSuccessfulNavigationContentLoad=function(t,n){e.Logger.info("UIShellPage._handleSuccessfulNavigationContentLoad: Entering.");var o=this._getSavedTabStates(),i=h.getQueryParameters(window.location.href),a=this._isNavigationInContextLaunch(i),l=this._isNotificationsInContextLaunch(i),s=this._isFavoritesInContextLaunch(i);null!==o||(a||l||s)?a?this._handleNavigationInContextLaunch(o,n,i):l?this._handleNotificationInContextLaunch(o,n,i):s?this._handleFavoriteInContextLaunch(o,n,i):o.length>0&&this._openTabStates(o,n):this._handleDefaultContentLoad(t),r.stopProcessingIndicator()},A.prototype._getSavedTabStates=function(){var e=f.get();return p.isArray(e)?e:null},A.prototype._isNavigationInContextLaunch=function(e){return p.isObjectStrict(e)&&p.isNonemptyString(e.jrafContentId)},A.prototype._isNotificationsInContextLaunch=function(e){return p.isObjectStrict(e)&&p.isNonemptyString(e.jrafNotificationId)},A.prototype._isFavoritesInContextLaunch=function(e){return p.isObjectStrict(e)&&p.isNonemptyString(e.jrafFavoriteId)},A.prototype._getInContextLaunchParams=function(e){var t=n.extend({},e);return[N.getRootRouterName(),"jrafContentId","jrafNotificationId","jrafFavoriteId"].forEach((function(e){delete t[e]})),t},A.prototype._getNavigationContent=function(e,t){var n=t[e];return n instanceof a?n:null},A.prototype._handleNavigationInContextLaunch=function(t,n,o){var i=o.jrafContentId,a=this._getNavigationContent(i,n);if(null===a)return e.Logger.warn("UIShellPage._handleNavigationInContextLaunch: Could not find content",i),this._showErrorMessage("jraf.messages.inContextLaunch.invalidContentId"),void this._openTabStates(t,n);var r=this._getNavigationInContextLaunchTabState(o,a),l=this._hasTabStateToReuse(a,r,t)?this._mergeTabStates(r,t):this._appendTabState(r,t);this._openTabStates(l,n)},A.prototype._hasTabStateToReuse=function(e,t,n){return p.isArray(n)&&e.isReuseInstance()&&!e.getAllowContentKeyOverride()&&this._hasTabState(t,n)},A.prototype._hasTabState=function(e,t){return t.filter((function(t){return t.equals(e)})).length>0},A.prototype._mergeTabStates=function(e,t){return t.map((function(t){return t.equals(e)?e:t})).concat([e])},A.prototype._appendTabState=function(e,t){return p.isArray(t)?t.concat(e):[e]},A.prototype._getNavigationInContextLaunchTabState=function(e,t){var n=this._getInContextLaunchParams(e),o=e.jrafContentId,i=this._getContentKey(t,n),a=this._extendModuleBinding(t,n),r=this._extendModuleOptions(t,n);return new M({contentId:o,contentKey:i,moduleBinding:a,moduleOptions:r})},A.prototype._getContentKey=function(e,t){var n=Object.keys(t).length>0;return e.getAllowContentKeyOverride()&&n?this._generateContentKey(e,t):e.getContentKey()},A.prototype._generateContentKey=function(e,t){return e.getId()+"|"+Object.keys(t).sort().map((function(e){return e+"="+t[e]})).join("|")},A.prototype._extendModuleBinding=function(e,t){return e.hasModuleOptions()?null:n.extend(!0,{},e.getModuleBinding(),{params:t})},A.prototype._extendModuleOptions=function(e,t){return e.hasModuleOptions()?n.extend(!0,{},e.getModuleOptions(),{params:t}):null},A.prototype._handleNotificationInContextLaunch=function(t,n,o){e.Logger.info("UIShellPage._handleNotificationInContextLaunch: Handling notification in-context launch");var i=m.getNotificationsService(),a=!1;p.isObjectStrict(i)&&p.isFunction(i.markNotificationAsRead)&&p.isFunction(i.getNotificationContext)||(e.Logger.warn("UIShellPage._handleNotificationInContextLaunch: No notifications service available to serve request"),this._showErrorMessage("jraf.messages.inContextLaunch.notificationsNotEnabled"),a=!0);var r=parseInt(o.jrafNotificationId);p.isNumber(r)||(e.Logger.warn("UIShellPage._handleNotificationInContextLaunch: jrafNotificationId was not a valid id."),this._showErrorMessage("jraf.messages.inContextLaunch.invalidNotificationId"),a=!0),a?this._openTabStates(t,n):this._makeNotificationInContextLaunchCalls(r,t,n)},A.prototype._makeNotificationInContextLaunchCalls=function(e,t,n){var o=this;r.startProcessingIndicator();var i=m.getNotificationsService();return Promise.all([i.markNotificationAsRead(e,!0),i.getNotificationContext(e)]).then((function(e){o._handleSuccessfulNotificationCalls(e[1],t,n)}),(function(e){o._handleFailedNotificationCalls(e,t,n)}))},A.prototype._handleSuccessfulNotificationCalls=function(t,n,o){var i=a.completeContent(t);null===i&&e.Logger.error("UIShellPage._handleSuccessfulNotificationCalls: Failed to parse notification context into Content"),this._openTabStates(n,o),i instanceof a&&r.openContent(i),r.stopProcessingIndicator()},A.prototype._handleFailedNotificationCalls=function(t,n,o){e.Logger.error("UIShellPage._handleFailedNotificationCalls:",t),this._openTabStates(n,o),this._showErrorMessage("jraf.messages.inContextLaunch.notificationServiceError"),r.stopProcessingIndicator()},A.prototype._openTabStates=function(t,n){p.isArray(t)&&0!==t.length?t.map((function(e){var t=this._getNavigationContent(e.contentId,n);return null===t?null:a.extendContent(t,{contentKey:e.contentKey,moduleBinding:e.moduleBinding,moduleOptions:e.moduleOptions})}),this).filter((function(e){return null!==e})).forEach((function(e){r.openContent(e)})):e.Logger.warn("UIShellPage._openTabStates: Exiting since no tab states were provided.")},A.prototype._handleFailedNavigationContentLoad=function(t){e.Logger.error("UIShellPage._handleFailedNavigationContentLoad: "+t),r.stopProcessingIndicator()},A.prototype._handleDefaultContentLoad=function(t){t.forEach((function(t){if(p.isObjectStrict(t)){var n=null;try{n=new a(t)}catch(t){e.Logger.warn("UIShellPage._handleDefaultContentLoad: Error parsing default content.")}n instanceof a&&this._openDefaultContent(n)}}),this)},A.prototype._openDefaultContent=function(e){if(e.isDefaultContent())r.openContent(e);else if(e.isFolder())for(var t=e.getChildren(),n=0;n<t.length;n++)this._openDefaultContent(t[n])},A.prototype._initializeBadgeValuePolling=function(e){var t=e.getMenuItems();if(p.isArray(t)){var n=t.filter((function(e){return e.isBadgingEnabled()&&e.getBadgeValueRefresh()})).map((function(e){return e.getBadgeValueRefresh()}));this._pollingManager=new L({key:"UIShellPage",interval:e.getPollingInterval(),callbacks:n})}},A.prototype._beginPolling=function(){this._pollingManager&&this._pollingManager.startPolling(!0)},A.prototype._endPolling=function(){this._pollingManager&&this._pollingManager.stopPolling()},A.prototype._handleApplicationLogout=function(){this._closeConfirmLogoutDialog(),o.App.clearAppData(),f.clear(),o.App.clearAppDataProperty(o.App.GLOBAL_HEADER_CONFIG_KEY),p.isFunction(this._logoutCallback)&&this._logoutCallback()},A.prototype._openConfirmLogoutDialog=function(){var e=this.unsavedChangesCallback();this.confirmLogoutText(e?this.confirmLogoutDefaultText:this.confirmLogoutNoChangeText),this._getConfirmLogoutDialog().open()},A.prototype._closeConfirmLogoutDialog=function(){this._getConfirmLogoutDialog().close()},A.prototype._getConfirmLogoutDialog=function(){return document.getElementById(this.confirmLogoutId)},A.prototype._showErrorMessage=function(t){var n=e.Translations.getTranslatedString(t);this.errorMessage(n);var o=document.getElementById(this.errorDialogId);e.Context.getContext(o).getBusyContext().whenReady().then((function(){o.open()}))},A.prototype.mobileSearchAnimation=function(e){"open"===e.detail.action&&(e.preventDefault(),j.fadeIn(e.detail.element,{duration:"200ms",persist:"all"}).then(e.detail.endCallback)),"close"===e.detail.action&&(e.preventDefault(),j.fadeOut(e.detail.element,{duration:"200ms",persist:"all"}).then(e.detail.endCallback))},A.prototype._handleFavoriteInContextLaunch=function(t,n,o){e.Logger.info("UIShellPage._handleFavoriteInContextLaunch: Handling favorites in-context launch");var i=parseInt(o.jrafFavoriteId);if(!p.isNumber(i))return e.Logger.warn("UIShellPage._handleFavoriteInContextLaunch: jrafFavoriteId was not a valid id."),this._showErrorMessage("jraf.messages.inContextLaunch.invalidFavoriteId"),void this._openTabStates(t,n);var a=v.getInstance().getFavoriteHandler();this._openTabStates(t,n),a.openContent(i)},A.prototype.canExit=function(){return f.clear(),Promise.resolve()},A}));